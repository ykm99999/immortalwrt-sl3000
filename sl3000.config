#
# Automatically generated file; DO NOT EDIT.
# ImmortalWrt Configuration - 司洛 SL-3000 EMMC 优化版 - 修复增强版
#

# ===== 基础系统配置 =====
CONFIG_MODULES=y
CONFIG_HAVE_DOT_CONFIG=y
CONFIG_TARGET_mediatek=y
CONFIG_TARGET_mediatek_mt7981=y
CONFIG_TARGET_mediatek_mt7981_DEVICE_sl_3000-emmc=y
CONFIG_TARGET_BOARD="mediatek"
CONFIG_TARGET_SUBTARGET="mt7981"
CONFIG_TARGET_PROFILE="DEVICE_sl_3000-emmc"
CONFIG_TARGET_ARCH_PACKAGES="aarch64_cortex-a53"
CONFIG_DEFAULT_TARGET_OPTIMIZATION="-Os -pipe -mcpu=cortex-a53 -mtune=cortex-a53"
CONFIG_CPU_TYPE="cortex-a53"
CONFIG_LINUX_5_4=y

# ===== 镜像配置优化 =====
CONFIG_TARGET_ROOTFS_SQUASHFS=y
CONFIG_TARGET_SQUASHFS_BLOCK_SIZE=256
CONFIG_TARGET_ROOTFS_PARTSIZE=512
CONFIG_TARGET_ROOTFS_TARGZ=y
# CONFIG_TARGET_ROOTFS_INITRAMFS=n     # 禁用initramfs节省空间

# ===== 全局构建设置优化 =====
CONFIG_JSON_OVERVIEW_IMAGE_INFO=y
CONFIG_SIGNED_PACKAGES=y
CONFIG_DOWNLOAD_CHECK_CERTIFICATE=y
CONFIG_DEVEL=y

# 启用CCache加速编译
CONFIG_CCACHE=y
CONFIG_CCACHE_DIR=""

# 内核构建优化
CONFIG_KERNEL_BUILD_USER="SL3000-User"
CONFIG_KERNEL_BUILD_DOMAIN="local"
# CONFIG_KERNEL_DEBUG_INFO_REDUCED=n   # 修复：完全禁用调试信息
CONFIG_KERNEL_FRAME_WARN=1024          # 降低帧警告大小
CONFIG_KERNEL_CGROUPS=y
CONFIG_KERNEL_NAMESPACES=y
CONFIG_KERNEL_USER_NS=y
CONFIG_KERNEL_SECCOMP=y
CONFIG_KERNEL_IPV6=y
CONFIG_KERNEL_CC_OPTIMIZE_FOR_PERFORMANCE=y

# 禁用不必要的调试信息 - 修复配置冲突
CONFIG_KERNEL_DEBUG_INFO=n
CONFIG_KERNEL_DEBUG_KERNEL=n
CONFIG_KERNEL_DEBUG_FS=n

# 内核安全增强
CONFIG_KERNEL_SECCOMP_FILTER=y
CONFIG_KERNEL_STACKPROTECTOR_STRONG=y
CONFIG_KERNEL_SLAB_FREELIST_HARDENED=y
CONFIG_KERNEL_SLAB_FREELIST_RANDOM=y
CONFIG_KERNEL_KALLSYMS=n               # 减少内核大小
CONFIG_KERNEL_PROFILING=n              # 禁用性能分析

# Docker必需内核选项（完整版）
CONFIG_KERNEL_CGROUP_DEVICE=y
CONFIG_KERNEL_CGROUP_FREEZER=y
CONFIG_KERNEL_CGROUP_PIDS=y
CONFIG_KERNEL_CGROUP_BPF=y
CONFIG_KERNEL_MEMCG=y
CONFIG_KERNEL_NET_CLS_CGROUP=y
CONFIG_KERNEL_BLK_CGROUP=y
CONFIG_KERNEL_FHANDLE=y
CONFIG_KERNEL_FANOTIFY=y
CONFIG_KERNEL_POSIX_MQUEUE=y

# 包构建优化
CONFIG_MOLD=y
CONFIG_IPV6=y

# 安全加固
CONFIG_PKG_ASLR_PIE_REGULAR=y
CONFIG_PKG_CC_STACKPROTECTOR_REGULAR=y
CONFIG_PKG_FORTIFY_SOURCE_2=y
CONFIG_PKG_RELRO_FULL=y

# 工具链优化
CONFIG_BINUTILS_USE_VERSION_2_42=y
CONFIG_GCC_USE_VERSION_13=y
CONFIG_LIBC_USE_MUSL=y
CONFIG_USE_MUSL=y
CONFIG_EXTRA_OPTIMIZATION="-fno-caller-saves -fno-plt -fno-strict-aliasing"

# ===== 默认包选择优化 =====
CONFIG_DEFAULT_autocore-arm=y
CONFIG_DEFAULT_automount=y
CONFIG_DEFAULT_base-files=y
CONFIG_DEFAULT_blkid=y
CONFIG_DEFAULT_block-mount=y
CONFIG_DEFAULT_blockdev=y
CONFIG_DEFAULT_ca-bundle=y
CONFIG_DEFAULT_ca-certificates=y        # 新增：SSL证书链
CONFIG_DEFAULT_default-settings-chn=y
CONFIG_DEFAULT_dnsmasq-full=y
CONFIG_DEFAULT_dropbear=y
CONFIG_DEFAULT_f2fsck=y
CONFIG_DEFAULT_fdisk=y
CONFIG_DEFAULT_firewall=y               # 新增：基础防火墙
CONFIG_DEFAULT_firewall4=y
CONFIG_DEFAULT_fstools=y
CONFIG_DEFAULT_kmod-fs-f2fs=y
CONFIG_DEFAULT_kmod-gpio-button-hotplug=y
CONFIG_DEFAULT_kmod-leds-gpio=y
CONFIG_DEFAULT_kmod-mmc=y
CONFIG_DEFAULT_kmod-nf-nathelper=y
CONFIG_DEFAULT_kmod-nft-offload=y
CONFIG_DEFAULT_kmod-nls-cp437=y
CONFIG_DEFAULT_kmod-nls-iso8859-1=y
CONFIG_DEFAULT_libc=y
CONFIG_DEFAULT_libgcc=y
CONFIG_DEFAULT_libustream-openssl=y
CONFIG_DEFAULT_logd=y
CONFIG_DEFAULT_losetup=y
CONFIG_DEFAULT_mkf2fs=y
CONFIG_DEFAULT_mtd=y
CONFIG_DEFAULT_mtk-smp=y
CONFIG_DEFAULT_netifd=y
CONFIG_DEFAULT_nftables=y
CONFIG_DEFAULT_odhcp6c=y
CONFIG_DEFAULT_odhcpd-ipv6only=y
CONFIG_DEFAULT_ppp=y
CONFIG_DEFAULT_ppp-mod-pppoe=y
CONFIG_DEFAULT_procd-ujail=y
CONFIG_DEFAULT_uboot-envtool=y
CONFIG_DEFAULT_uci=y
CONFIG_DEFAULT_uclient-fetch=y
CONFIG_DEFAULT_urandom-seed=y
CONFIG_DEFAULT_urngd=y

# Dropbear安全优化
CONFIG_DROPBEAR_ASKPASS=n               # 禁用密码提示
CONFIG_DROPBEAR_DISABLE_REVERSEDNS=y    # 禁用反向DNS

# ===== Docker 完整支持 =====
CONFIG_PACKAGE_docker=y
CONFIG_PACKAGE_dockerd=y
CONFIG_PACKAGE_docker-compose=y
CONFIG_PACKAGE_containerd=y
CONFIG_PACKAGE_runc=y
CONFIG_PACKAGE_tini=y
CONFIG_PACKAGE_libnetwork=y

# Docker 存储驱动完整支持
CONFIG_PACKAGE_kmod-fs-btrfs=y
CONFIG_PACKAGE_kmod-fs-overlayfs=y      # 新增：Docker必需
CONFIG_PACKAGE_kmod-dm=y
CONFIG_PACKAGE_kmod-dm-thin-pool=y      # 新增：精简配置支持
CONFIG_PACKAGE_kmod-dax=y               # 新增：容器持久内存支持
CONFIG_PACKAGE_kmod-br-netfilter=y
CONFIG_PACKAGE_kmod-veth=y
CONFIG_PACKAGE_kmod-ikconfig=y

# ===== PassWall2 相关包 =====
CONFIG_PACKAGE_luci-app-passwall2=y
CONFIG_PACKAGE_luci-i18n-passwall2-zh-cn=y

# PassWall2 核心依赖
CONFIG_PACKAGE_luci-compat=y
CONFIG_PACKAGE_luci-lib-ipkg=y
CONFIG_PACKAGE_libopenssl=y

# 代理协议支持
CONFIG_PACKAGE_shadowsocks-libev-ss-local=y
CONFIG_PACKAGE_shadowsocks-libev-ss-redir=y
CONFIG_PACKAGE_shadowsocks-libev-ss-server=y
CONFIG_PACKAGE_shadowsocks-rust-sslocal=y
CONFIG_PACKAGE_shadowsocks-rust-ssserver=y
CONFIG_PACKAGE_simple-obfs=y
CONFIG_PACKAGE_v2ray-core=y
CONFIG_PACKAGE_xray-core=y
CONFIG_PACKAGE_trojan=y
CONFIG_PACKAGE_trojan-plus=y
CONFIG_PACKAGE_trojan-go=y
CONFIG_PACKAGE_naiveproxy=y
CONFIG_PACKAGE_hysteria=y
CONFIG_PACKAGE_tuic-client=y

# DNS 相关
CONFIG_PACKAGE_chinadns-ng=y
CONFIG_PACKAGE_dns2socks=y
CONFIG_PACKAGE_dns2tcp=y
CONFIG_PACKAGE_microsocks=y
CONFIG_PACKAGE_ipt2socks=y
CONFIG_PACKAGE_v2ray-geoip=y
CONFIG_PACKAGE_v2ray-geosite=y

# ===== 内核模块优化 =====
# 文件系统（精简但完整）
CONFIG_PACKAGE_kmod-fs-autofs4=y
CONFIG_PACKAGE_kmod-fs-ext4=y
CONFIG_PACKAGE_kmod-fs-f2fs=y
CONFIG_PACKAGE_kmod-fs-vfat=y
# CONFIG_PACKAGE_kmod-fs-exfat=n       # 移除不必要文件系统
# CONFIG_PACKAGE_kmod-fs-ntfs3=n

# 网络核心
CONFIG_PACKAGE_kmod-ip6tables=y
CONFIG_PACKAGE_kmod-ipt-conntrack=y
CONFIG_PACKAGE_kmod-ipt-core=y
CONFIG_PACKAGE_kmod-ipt-nat=y
CONFIG_PACKAGE_kmod-ipt-offload=y
CONFIG_PACKAGE_kmod-nf-conntrack=y
CONFIG_PACKAGE_kmod-nf-nat=y
CONFIG_PACKAGE_kmod-nft-core=y
CONFIG_PACKAGE_kmod-nft-offload=y

# 网络优化和流量整形
CONFIG_PACKAGE_kmod-tcp-bbr=y
CONFIG_PACKAGE_kmod-ifb=y
CONFIG_PACKAGE_kmod-macvlan=y
CONFIG_PACKAGE_kmod-sched-cake=y        # 新增：流量整形
CONFIG_PACKAGE_kmod-sched-bpf=y         # 新增：调度器优化

# 防火墙扩展
CONFIG_PACKAGE_iptables-mod-extra=y     # 新增：扩展防火墙功能
CONFIG_PACKAGE_iptables-mod-conntrack-extra=y
CONFIG_PACKAGE_iptables-mod-ipopt=y

# MTK 硬件加速
CONFIG_PACKAGE_kmod-mediatek_hnat=y
CONFIG_PACKAGE_kmod-mt_wifi=y

# USB 存储支持
CONFIG_PACKAGE_kmod-usb-storage=y       # 新增：USB存储支持
CONFIG_PACKAGE_kmod-usb3=y              # 新增：USB3.0支持
CONFIG_PACKAGE_kmod-usb-core=y

# ===== LuCI 配置优化 =====
CONFIG_PACKAGE_luci=y
CONFIG_PACKAGE_luci-base=y
CONFIG_PACKAGE_luci-compat=y
CONFIG_PACKAGE_luci-light=y
CONFIG_PACKAGE_luci-mod-admin-full=y
CONFIG_PACKAGE_luci-mod-network=y
CONFIG_PACKAGE_luci-mod-status=y
CONFIG_PACKAGE_luci-mod-system=y
CONFIG_PACKAGE_luci-theme-argon=y

# 其他实用LuCI应用
CONFIG_PACKAGE_luci-app-turboacc-mtk=y
CONFIG_PACKAGE_luci-app-upnp-mtk-adjust=y
CONFIG_PACKAGE_luci-app-dockerman=y
CONFIG_PACKAGE_luci-i18n-dockerman-zh-cn=y

# 系统监控LuCI应用
CONFIG_PACKAGE_luci-app-statistics=y    # 新增：系统统计
CONFIG_PACKAGE_luci-i18n-statistics-zh-cn=y

# ===== 库文件优化 =====
CONFIG_PACKAGE_libatomic=y
CONFIG_PACKAGE_libc=y
CONFIG_PACKAGE_libgcc=y
CONFIG_PACKAGE_libpthread=y
CONFIG_PACKAGE_librt=y
CONFIG_PACKAGE_libstdcpp=y

# 网络库
CONFIG_PACKAGE_libopenssl=y
CONFIG_OPENSSL_OPTIMIZE_SPEED=y
CONFIG_OPENSSL_WITH_ASM=y
CONFIG_OPENSSL_WITH_TLS13=y

CONFIG_PACKAGE_libpcap=y
CONFIG_PACKAGE_libubox=y
CONFIG_PACKAGE_libubus=y
CONFIG_PACKAGE_libuci=y
CONFIG_PACKAGE_libuclient=y
CONFIG_PACKAGE_libustream-openssl=y
CONFIG_PACKAGE_zlib=y

# ===== 系统工具优化 =====
CONFIG_PACKAGE_htop=y
CONFIG_PACKAGE_htop-process-trees=y     # 新增：进程树显示
CONFIG_PACKAGE_nano=y
CONFIG_PACKAGE_tcpdump=y
CONFIG_PACKAGE_ethtool=y
CONFIG_PACKAGE_ethtool-full=y           # 新增：完整网卡工具
CONFIG_PACKAGE_iw=y
CONFIG_PACKAGE_usbutils=y

# 系统监控工具
CONFIG_PACKAGE_bmon=y                   # 新增：带宽监控
CONFIG_PACKAGE_iftop=y                  # 新增：流量监控
CONFIG_PACKAGE_mtr=y                    # 新增：网络诊断
CONFIG_PACKAGE_traceroute=y             # 新增：路由追踪
CONFIG_PACKAGE_smartmontools=y          # 新增：磁盘健康监测
CONFIG_PACKAGE_lm-sensors=y             # 新增：硬件监控
CONFIG_PACKAGE_irqbalance=y             # 新增：IRQ负载均衡

# 存储工具
CONFIG_PACKAGE_e2fsprogs=y              # 新增：ext4工具集
CONFIG_PACKAGE_resize2fs=y              # 新增：文件系统调整

# ===== 硬件特性支持 =====
CONFIG_HAS_FPU=y
CONFIG_AUDIO_SUPPORT=y
CONFIG_GPIO_SUPPORT=y
CONFIG_PCI_SUPPORT=y
CONFIG_RTC_SUPPORT=y
CONFIG_EMMC_SUPPORT=y
CONFIG_NAND_SUPPORT=y
CONFIG_ARCH_64BIT=y
CONFIG_aarch64=y

# ===== 包源配置 =====
CONFIG_PER_FEED_REPO=y
CONFIG_FEED_packages=y
CONFIG_FEED_luci=y
CONFIG_FEED_routing=y
CONFIG_FEED_telephony=y

# ===== 编译优化参数 =====
# 修复编译优化冲突
CONFIG_USE_STRIP=y
CONFIG_USE_SSTRIP=y
CONFIG_STRIP_KERNEL_EXPORTS=y
CONFIG_USE_MKLIBS=y

# 移除调试符号 - 修复冲突
# CONFIG_NO_STRIP=n                    # 修复：禁用NO_STRIP
# CONFIG_DEBUG=n                       # 修复：禁用DEBUG

# 包选择优化
CONFIG_PACKAGE_bash=y                   # 更好的shell支持
CONFIG_PACKAGE_curl=y                   # HTTP客户端
CONFIG_PACKAGE_wget=y                   # 下载工具
CONFIG_PACKAGE_socat=y                  # 网络工具

# 网络服务
CONFIG_PACKAGE_openssh-sftp-server=y    # SFTP支持
CONFIG_PACKAGE_samba4-server=y          # 文件共享
CONFIG_PACKAGE_samba4-libs=y
CONFIG_PACKAGE_minidlna=y               # DLNA媒体服务器

# 系统管理
CONFIG_PACKAGE_cron=y                   # 计划任务
CONFIG_PACKAGE_logrotate=y              # 日志轮转
CONFIG_PACKAGE_rsync=y                  # 文件同步

# 性能监控
CONFIG_PACKAGE_sysstat=y                # 系统性能监控
CONFIG_PACKAGE_dstat=y                  # 资源统计
CONFIG_PACKAGE_iperf3=y                 # 网络性能测试

# ===== 固件生成选项 =====
CONFIG_IB=y
CONFIG_SDK=y
CONFIG_IMAGEOPT=y
CONFIG_COLLECT_KERNEL_DEBUG=y

# 构建后缀
CONFIG_VERSION_DIST="ImmortalWrt"
CONFIG_VERSION_NICK=""
CONFIG_VERSION_NUMBER=""
CONFIG_VERSION_REPO="https://downloads.immortalwrt.org/releases/21.02.7"

# 镜像生成选项
CONFIG_TARGET_IMAGES_PAD=y
CONFIG_TARGET_KERNEL_PARTSIZE=32
CONFIG_TARGET_ROOTFS_PARTSIZE=512

# 分区布局
CONFIG_TARGET_mediatek_mt7981_DEVICE_sl_3000-emmc_LAYOUT="emmc"
CONFIG_TARGET_KERNEL_PARTSIZE=32
CONFIG_TARGET_ROOTFS_PARTSIZE=512

# 编译线程优化
CONFIG_BUILD_SUFFIX="immortalwrt"
CONFIG_BUILD_LOG_SUFFIX=""

# 本地化设置
CONFIG_TARGET_ROOTFS_PARTSIZE=512
CONFIG_TARGET_ROOTFS_SQUASHFS=y
CONFIG_TARGET_SQUASHFS_BLOCK_SIZE=256
CONFIG_TARGET_USES_ROOTFS_DATA_PARTITION=y
CONFIG_TARGET_USES_SQUASHFS=y

# 最终构建选项
CONFIG_AUTOREMOVE=y
CONFIG_BUILDBOT=y
